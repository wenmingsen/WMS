<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.csg.statistics.mapper.DrtAccountRecordMapper">
	<resultMap id="BaseResultMap" type="com.csg.statistics.entity.DrtAccountRecord">
		<id column="ACCOUNT_RECORD_ID" property="accountRecordId"></id>
		<result column="ACCOUNT_ID" property="accountId" />
		<result column="PHONE" property="phone" />
		<result column="RECORD_TYPE" property="recordType" />
		<result column="CREATE_TIME" property="createTime" />
		<result column="IP_ADDRESS" property="ipAddress" />
		<result column="REMARK" property="remark" />
	</resultMap>
	
	<sql id="BaseColumnList">
		ACCOUNT_RECORD_ID as accountRecordId,
		ACCOUNT_ID as accountId,
		PHONE as phone,
		RECORD_TYPE as recordType,
		CREATE_TIME as createTime,
		IP_ADDRESS as ipAddress,
		REMARK as remark
	</sql>

	<sql id="BaseCustomQueryCondition">
		<if test="accountRecordId != null">
			and ACCOUNT_RECORD_ID=#{accountRecordId}
		</if>
		<if test="accountId != null">
			and ACCOUNT_ID=#{accountId}
		</if>
		<if test="phone != null">
			and PHONE=#{phone}
		</if>
		<if test="recordType != null">
			and RECORD_TYPE=#{recordType}
		</if>
		<if test="createTime != null">
			and CREATE_TIME=#{createTime}
		</if>
		<if test="ipAddress != null">
			and IP_ADDRESS=#{ipAddress}
		</if>
		<if test="remark != null">
			and REMARK=#{remark}
		</if>
	</sql>

	<insert id="insert" parameterType="com.csg.statistics.entity.DrtAccountRecord" >
    	insert into drt_account_record
    		(ACCOUNT_RECORD_ID, ACCOUNT_ID, PHONE, RECORD_TYPE, CREATE_TIME, IP_ADDRESS, REMARK) 
    	values
    		(#{accountRecordId}, #{accountId}, #{phone}, #{recordType}, #{createTime}, #{ipAddress}, #{remark})
  	</insert>

  	<update id="update" parameterType="com.csg.statistics.entity.DrtAccountRecord">
		update drt_account_record set
		ACCOUNT_ID=#{accountId}, PHONE=#{phone}, RECORD_TYPE=#{recordType}, CREATE_TIME=#{createTime}, IP_ADDRESS=#{ipAddress}, REMARK=#{remark}
		where ACCOUNT_RECORD_ID = #{accountRecordId}
	</update>

	<select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
	    select 
	    <include refid="BaseColumnList" />
	    from drt_account_record
	    where 
			ACCOUNT_RECORD_ID = #{accountRecordId}
  	</select>

  	<select id="selectList" resultMap="BaseResultMap" parameterType="com.csg.statistics.entity.DrtAccountRecord">
	    select 
	    <include refid="BaseColumnList" />
	    from drt_account_record
	    where 1=1
	    <include refid="BaseCustomQueryCondition" />
  	</select>
  	
  	  	<select id="selectListByDrtAccountRecord" resultMap="BaseResultMap" parameterType="com.csg.statistics.entity.DrtAccountRecord">
	    select 
	    <include refid="BaseColumnList" />
	    from drt_account_record
	    where 1=1 and DATE(create_time) = DATE_SUB(DATE(CURRENT_TIMESTAMP()), INTERVAL 1 DAY)
	    <include refid="BaseCustomQueryCondition" />
  	</select>


	
</mapper>